<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="CodeSQL">

	<sql id="where_code">
		<trim prefix="WHERE" prefixOverrides="AND | OR">
			<if test="commcd != null and commcd != ''" >
				AND COMMCD = #{commcd}
			</if>
			<if test="commcd_seq != null and commcd_seq != ''" >
				AND COMMCD_SEQ = #{commcd_seq}
			</if>
			<if test="commcd_gcd != null and commcd_gcd != ''" >
				AND COMMCD_GCD = #{commcd_gcd}
			</if>
			<if test="up_commcd != null and up_commcd != ''" >
				AND UP_COMMCD = #{up_commcd}
			</if>
			<if test="etc_cd != null and etc_cd != ''" >
				AND ETC_CD IN
				<foreach collection="etc_cd" index="index" item="item" open="(" separator="," close=")">
        		#{item}
  				</foreach>
			</if>
		</trim>
	</sql>


	<select id="CodeSQL.countCode" parameterType="dataMap" resultType="int">
		/*
			SQL ID : CodeSQL.countCode
			공통코드 카운트
		*/

		SELECT COUNT(COMMCD) FROM TA_COMM_CODE
		WHERE USEYN = 'Y'
		<if test="commcd_gcd != null and commcd_gcd != ''" >
			AND COMMCD_GCD = #{commcd_gcd}
		</if>
		<if test="up_commcd != null and up_commcd != ''" >
			AND UP_COMMCD = #{up_commcd}
		</if>
		<if test="etc_cd != null and etc_cd != ''" >
			AND ETC_CD IN
			<foreach collection="etc_cd" index="index" item="item" open="(" separator="," close=")">
    		#{item}
			</foreach>
		</if>

	</select>


	<select id="CodeSQL.dolistCode" parameterType="dataMap" resultType="dataMap">
		/*
			SQL ID : CodeSQL.dolistCode
			공통코드 목록 조회
		*/

		SELECT COMMCD_SEQ
			, COMMCD
			, COMMCD_GCD
			, UP_SEQ
			, UP_COMMCD
			, CDNM
			, CDNM_EN
			, CDNM_JP
			, CDNM_CN
			, CDNM_ETC
			, COMMCD_CMMT
			, ETC_CD
			, COMMCD_PCD
			, COMMCD_TCD
			, COMMCD_LVL
			, COMMCD_IDX
			, COMMCD_RFK
			, REGUID
			, MODUID
			, REGDTM
			, MODDTM
			, USEYN
			, ASPSID
		FROM TA_COMM_CODE
		WHERE USEYN = 'Y'
		<if test="commcd_gcd != null and commcd_gcd != ''" >
			AND COMMCD_GCD = #{commcd_gcd}
		</if>
		<if test="up_commcd != null and up_commcd != ''" >
			AND UP_COMMCD = #{up_commcd}
		</if>
		<if test="etc_cd != null and etc_cd != ''" >
			AND ETC_CD IN
			<foreach collection="etc_cd" index="index" item="item" open="(" separator="," close=")">
    		#{item}
			</foreach>
		</if>
		ORDER BY COMMCD_IDX, COMMCD

	</select>


	<select id="CodeSQL.getoneCode" parameterType="dataMap" resultType="dataMap">
		/*
			SQL ID : CodeSQL.getoneCode
			공통코드 정보 조회
		*/

		SELECT COMMCD_SEQ
			, COMMCD
			, COMMCD_GCD
			, UP_SEQ
			, UP_COMMCD
			, CDNM
			, CDNM_EN
			, CDNM_JP
			, CDNM_CN
			, CDNM_ETC
			, COMMCD_CMMT
			, ETC_CD
			, COMMCD_PCD
			, COMMCD_TCD
			, COMMCD_LVL
			, COMMCD_IDX
			, COMMCD_RFK
			, REGUID
			, MODUID
			, REGDTM
			, MODDTM
			, USEYN
			, SITEID
		FROM TA_COMM_CODE
		WHERE USEYN = 'Y'
		<if test="commcd != null and commcd != ''" >
			AND COMMCD = #{commcd}
		</if>
		<if test="commcd_seq != null and commcd_seq != ''" >
			AND COMMCD_SEQ = #{commcd_seq}
		</if>

	</select>


	<insert id="CodeSQL.appendCode" parameterType="dataMap" useGeneratedKeys="false">
		/*
			SQL ID : CodeSQL.appendCode
			공통코드 등록
		*/

		INSERT INTO TA_COMM_CODE
			( COMMCD_SEQ
			, COMMCD
			, COMMCD_GCD
			, UP_SEQ
			, UP_COMMCD
			, CDNM
			, CDNM_EN
			, CDNM_JP
			, CDNM_CN
			, CDNM_ETC
			, COMMCD_CMMT
			, ETC_CD
			, COMMCD_PCD
			, COMMCD_TCD
			, COMMCD_LVL
			, COMMCD_IDX
			, COMMCD_RFK
			, REGUID
			, MODUID
			, REGDTM
			, MODDTM
			, USEYN
			, SITEID
			)
		VALUES
			( #{commcd_seq}
			, #{commcd}
			, #{commcd_gcd}
			, #{up_seq}
			, #{up_commcd}
			, #{cdnm}
			, #{cdnm_en}
			, #{cdnm_jp}
			, #{cdnm_cn}
			, #{cdnm_etc}
			, #{commcd_cmmt}
			, #{etc_cd}
			, #{commcd_pcd}
			, #{commcd_tcd}
			, #{commcd_lvl}
			, #{commcd_idx}
			, #{commcd_rfk}
			, #{reguid}
			, #{moduid}
			, TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			, TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
			, #{useyn}
			, #{siteid}
			)

	</insert>


	<delete id="CodeSQL.removeCode" parameterType="DataMap">
		/*
			SQL ID: CodeSQL.removeCode
			공통코드 삭제
		*/

		DELETE FROM TA_COMM_CODE
		WHERE
		<include refid="where_code"/>

	</delete>


	<update id="CodeSQL.modifyCode" parameterType="DataMap">
		/*
			SQL ID: CodeSQL.modifyCode
			메인코드 수정
		*/

		UPDATE TA_COMM_CODE
		SET CDNM	= #{cdnm},
			COMMCD_CMMT	= #{commcd_cmmt},
		<if test="commcd_idx != null and commcd_idx != ''" >
			COMMCD_IDX = #{commcd_idx},
		</if>
			USEYN		= #{useyn},
			MODUID		= #{moduid},
			MODDTM		= TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
		WHERE  COMMCD = #{commcd}
	</update>


</mapper>